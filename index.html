<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Notificações a cada 2 segundos</title>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; padding: 50px; background: #f0f0f0; }
    button { padding: 15px 30px; font-size: 18px; cursor: pointer; margin: 20px; }
    #status { margin-top: 20px; font-size: 20px; }
  </style>
</head>
<body>
  <h1>Notificações a cada 2 segundos</h1>
  <p>Clique no botão abaixo e permita as notificações.</p>
  <button id="btnPermitir">Ativar Notificações Insanas</button>
  <div id="status"></div>

  <script>
    const status = document.getElementById('status');
    let contador = 0;
    let intervalo;

    // === 1. Verifica se o navegador suporta notificações ===
    if (!("Notification" in window)) {
      status.textContent = "Seu navegador não suporta notificações :(";
      return;
    }

    // === 2. Função que envia a notificação ===
    function enviarNotificacao() {
      contador++;
      new Notification("Notificação INSANA!", {
        body: `Já se passaram \( {contador * 2} segundos! Mensagem # \){contador}`,
        icon: "https://emojis.wiki/emoji-pics/apple/partying-face-apple.png",
        badge: "https://emojis.wiki/emoji-pics/apple/partying-face-apple.png",
        tag: "notificacao-insana", // evita duplicatas
        renotify: true            // faz vibrar de novo mesmo com mesmo tag
      });
    }

    // === 3. Quando clicar no botão ===
    document.getElementById('btnPermitir').addEventListener('click', async () => {
      // Pede permissão
      const permissao = await Notification.requestPermission();

      if (permissao === "granted") {
        status.textContent = "Permissão concedida! Notificações começando em 2s...";
        document.getElementById('btnPermitir').disabled = true;

        // Primeira notificação imediata
        enviarNotificacao();

        // Depois a cada 2 segundos
        intervalo = setInterval(enviarNotificacao, 2000);

      } else if (permissao === "denied") {
        status.textContent = "Você bloqueou as notificações :( Não dá pra continuar.";
      } else {
        status.textContent = "Permissão ainda não decidida...";
      }
    });

    // Opcional: parar quando a pessoa sair da página (pra não ficar enviando eternamente)
    window.addEventListener('beforeunload', () => {
      if (intervalo) clearInterval(intervalo);
    });
  </script>
</body>
</html>
